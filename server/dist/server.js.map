{"version":3,"sources":["../src/server.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;oBAAgB,KAAK;;;;uBACD,SAAS;;;;oBACZ,MAAM;;;;kBACR,IAAI;;;;6BACO,eAAe;;;;sBACtB,iBAAiB;;;;qBAClB,iBAAiB;;;;AAEnC,IAAM,IAAI,GAAG,gBAAG,IAAI,EAAE,CAAC,MAAM,CAAA;;IAEvB,MAAM;AACC,WADP,MAAM,GACI;0BADV,MAAM;;AAER,+BAFE,MAAM,6CAED;AACP,QAAI,CAAC,GAAG,GAAG,kBAAK,CAAA;AAChB,QAAI,CAAC,GAAG,CAAC,MAAM,sBAAS,CAAA;;AAExB,QAAI,CAAC,WAAW,GAAG;AACjB,YAAM,EAAE,OAAO;AACf,YAAM,EAAE,QAAQ;AAChB,UAAI,EAAE,oBAAO,UAAU;KACxB,CAAA;GACF;;YAXG,MAAM;;eAAN,MAAM;;WAYL,eAAC,QAAQ,EAAE;AACd,UAAI,CAAC,MAAM,EAAE,CAAA;AACb,UAAI,MAAM,GAAG,kBAAK,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAA;AACnD,aAAO,MAAM,CAAC,MAAM,CAAC,oBAAO,UAAU,EAAE,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAA;KACpE;;;WACK,kBAAG;AACP,yBAAM,IAAI,CAAC,GAAG,CAAC,CAAA;KAChB;;;WACgB,sBAAG;AAClB,aAAO,CAAC,EAAE,CAAC,MAAM,EAAE,UAAC,CAAC,EAAK;AACxB,cAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAA;OAC/B,CAAC,CAAA;AACF,aAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAA;KAC3B;;;SAzBG,MAAM;;;qBA4BG,MAAM","file":"server/src/server.js","sourcesContent":["import koa from 'koa'\nimport cluster from 'cluster'\nimport http from 'http'\nimport os from 'os'\nimport child_process from 'child_process'\nimport config from './config/config'\nimport route from './router/router'\n\nconst cpus = os.cpus().length\n\nclass Server extends koa {\n  constructor() {\n    super()\n    this.app = koa()\n    this.app.config = config\n      //pm2 实现reload热重载 这些先打酱油\n    this.serverEvent = {\n      action: 'start',\n      status: 'online',\n      port: config.listenPort\n    }\n  }\n  start(callback) {\n    this.router()\n    let server = http.createServer(this.app.callback())\n    return server.listen(config.listenPort, callback(this.serverEvent))\n  }\n  router() {\n    route(this.app)\n  }\n  static stopServer() {\n    process.on('exit', (e) => {\n      logger.warn('server is stop ')\n    })\n    process.exit('stopServer')\n  }\n}\n\nexport default Server"]}